# Remote MCP Server Integration

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö MCP —Å–µ—Ä–≤–µ—Ä–æ–≤ (Remote MCP) –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ª–æ–∫–∞–ª—å–Ω—ã–º MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º. –¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –ø—É–±–ª–∏—á–Ω—ã–º MCP —Å–µ—Ä–≤–µ—Ä–∞–º —á–µ—Ä–µ–∑ HTTP/SSE, —Ç–∞–∫–∏–º –∫–∞–∫ Kiwi.com flight search.

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –û—à–∏–±–∫–∞ "mcp_servers: Extra inputs are not permitted"

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—ã –ø—ã—Ç–∞–ª–∏—Å—å –¥–æ–±–∞–≤–∏—Ç—å `mcp_toolset` —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤ –º–∞—Å—Å–∏–≤ `tools`, —á—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ Claude API.

**–†–µ—à–µ–Ω–∏–µ:** 
- `mcp_servers` - –º–∞—Å—Å–∏–≤ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤ (URL, –∏–º—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
- `tools` - –º–∞—Å—Å–∏–≤ —Å `mcp_toolset` –æ–±—ä–µ–∫—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ –∏–º–µ–Ω–∏

### 2. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API –∑–∞–ø—Ä–æ—Å–∞

–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Claude (https://platform.claude.com/docs/en/agents-and-tools/mcp-connector):

```json
{
  "model": "claude-sonnet-4-5",
  "max_tokens": 1000,
  "messages": [...],
  "mcp_servers": [
    {
      "type": "url",
      "url": "https://mcp.kiwi.com",
      "name": "kiwi-com-flight-search"
    }
  ],
  "tools": [
    {
      "type": "mcp_toolset",
      "mcp_server_name": "kiwi-com-flight-search"
    }
  ]
}
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω beta header

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å MCP connector —Ç—Ä–µ–±—É–µ—Ç—Å—è beta header:
```
anthropic-beta: mcp-client-2025-11-20
```

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `RemoteMCPClient.kt`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö remote MCP —Å–µ—Ä–≤–µ—Ä–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤
- –°–µ—Ä–≤–µ—Ä Kiwi.com –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–∫–ª—é—á–µ–Ω

### 2. `ClaudeClient.kt`
- –û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `getFilteredTools()` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ remote MCP
- –î–æ–±–∞–≤–ª–µ–Ω beta header –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ remote MCP —Å–µ—Ä–≤–µ—Ä–æ–≤
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `mcp_toolset` –≤ –º–∞—Å—Å–∏–≤–µ `tools`

### 3. `MCPTools.kt`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è remote MCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ remote —Å–µ—Ä–≤–µ—Ä–æ–≤

### 4. `HealthRoutes.kt`
- –û–±–Ω–æ–≤–ª–µ–Ω endpoint `/api/tools` –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö, —Ç–∞–∫ –∏ remote –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `type` –¥–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### 5. `ApiModels.kt`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `type` –≤ `ToolInfo` ("local" –∏–ª–∏ "remote_mcp")

### 6. `ui/index.html`
- –û–±–Ω–æ–≤–ª–µ–Ω UI –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è remote MCP —Å–µ—Ä–≤–µ—Ä–æ–≤ –æ—Ç–¥–µ–ª—å–Ω–æ
- –í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ: –≥–æ–ª—É–±–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è remote —Å–µ—Ä–≤–µ—Ä–æ–≤
- –ò–∫–æ–Ω–∫–∞ üåê –¥–ª—è remote —Å–µ—Ä–≤–µ—Ä–æ–≤

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –í–∫–ª—é—á–∏—Ç—å Kiwi.com MCP —Å–µ—Ä–≤–µ—Ä –≤ UI

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (‚öôÔ∏è)
2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –¥–æ —Ä–∞–∑–¥–µ–ª–∞ "üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã MCP"
3. –ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é "üåê Remote MCP —Å–µ—Ä–≤–µ—Ä—ã"
4. –í–∫–ª—é—á–∏—Ç–µ —á–µ–∫–±–æ–∫—Å "kiwi-com-flight-search"

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —á–∞—Ç–µ

–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞, Claude —Å–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã Kiwi.com –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞–≤–∏–∞–±–∏–ª–µ—Ç–æ–≤:

```
–ù–∞–π–¥–∏ –º–Ω–µ —Ä–µ–π—Å—ã –∏–∑ –ú–æ—Å–∫–≤—ã –≤ –ü–∞—Ä–∏–∂ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö remote MCP —Å–µ—Ä–≤–µ—Ä–æ–≤

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `RemoteMCPClient.kt`:

```kotlin
private val availableServers = mapOf(
    "kiwi-com-flight-search" to RemoteMCPServerConfig(
        name = "kiwi-com-flight-search",
        url = "https://mcp.kiwi.com",
        description = "–ü–æ–∏—Å–∫ –∞–≤–∏–∞–±–∏–ª–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ Kiwi.com",
        enabled = false
    ),
    "your-server-name" to RemoteMCPServerConfig(
        name = "your-server-name",
        url = "https://your-mcp-server.com",
        description = "–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞",
        enabled = false
    )
)
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏ remote –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

- **–õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã** (`get_weather_forecast`, `get_solar_activity`) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Remote MCP —Å–µ—Ä–≤–µ—Ä—ã** –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö —á–µ—Ä–µ–∑ Claude API

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ `getToolsDefinitions()`

–ú–µ—Ç–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ª–æ–∫–∞–ª—å–Ω—ã–º –∏–ª–∏ remote —Å–µ—Ä–≤–µ—Ä–æ–º, –∏:
- –î–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- –î–ª—è remote: –≤–∫–ª—é—á–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ `setServerEnabled()`

### API –∑–∞–ø—Ä–æ—Å –∫ Claude

–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –≤–∫–ª—é—á–µ–Ω–Ω—ã—Ö remote —Å–µ—Ä–≤–µ—Ä–æ–≤:
1. –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ `mcp_servers` —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —Å–µ—Ä–≤–µ—Ä–æ–≤
2. –í –º–∞—Å—Å–∏–≤ `tools` –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è `mcp_toolset` –æ–±—ä–µ–∫—Ç—ã
3. –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è beta header `anthropic-beta: mcp-client-2025-11-20`

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. Remote MCP —Å–µ—Ä–≤–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ HTTP/SSE
2. –õ–æ–∫–∞–ª—å–Ω—ã–µ STDIO —Å–µ—Ä–≤–µ—Ä—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é
3. –ò–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ MCP –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ tool calls
4. MCP connector –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ Amazon Bedrock –∏ Google Vertex

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ UI –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é "üåê Remote MCP —Å–µ—Ä–≤–µ—Ä—ã"
4. –í–∫–ª—é—á–∏—Ç–µ "kiwi-com-flight-search"
5. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–∏—Å–∫ –∞–≤–∏–∞–±–∏–ª–µ—Ç–æ–≤
6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ API

